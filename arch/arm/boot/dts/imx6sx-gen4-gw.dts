/*
 * Copyright (C) 2016-2017 Panduit Inc.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 */

/dts-v1/;

#include <dt-bindings/input/input.h>
#include "imx6sx.dtsi"

/ {
	model = "Panduit i.MX6 SoloX VMX Gateway";
	compatible = "fsl,imx6sx-sdb", "fsl,imx6sx";

	chosen {
		stdout-path = &uart1;
	};

	memory {
		reg = <0x80000000 0x40000000>;
	};

	caam_keyblob: caam-keyblob {
		compatible = "fsl,sec-v4.0-keyblob";
		status = "okay";
	};

	regulators {
		compatible = "simple-bus";
		#address-cells = <1>;
		#size-cells = <0>;


		reg_psu_5v: regulator@1 {
			compatible = "regulator-fixed";
			reg = <1>;
			regulator-name = "PSU-5V0";
			regulator-min-microvolt = <5000000>;
			regulator-max-microvolt = <5000000>;
			regulator-boot-on;
		};

		reg_vref_3v3: regulator@2 {
			compatible = "regulator-fixed";
			regulator-name = "vref-3v3";
			regulator-min-microvolt = <3300000>;
			regulator-max-microvolt = <3300000>;
		};
	};

        leds {
		compatible = "gpio-leds";

		alarm-led {
			gpios = <&gpio4 2 GPIO_ACTIVE_HIGH>;
			default-state = "off";
		};

                status-led {
			gpios = <&gpio4 1 GPIO_ACTIVE_HIGH>;
                        linux,default-trigger = "timer";
			default-state = "on";
		};
	};
};

&adc1 {
	vref-supply = <&reg_vref_3v3>;
	status = "okay";
};

&cpu0 {
	operating-points = <
		/* kHz    uV */
		996000  1275000
		792000  1175000
		396000  1175000
		198000	1175000
		>;
	fsl,soc-operating-points = <
		/* ARM kHz      SOC uV */
		996000	1275000
		792000	1175000
		396000	1175000
		198000	1175000
	>;
	arm-supply = <&sw1a_reg>;
	soc-supply = <&sw1a_reg>;
	fsl,arm-soc-shared = <1>;
};

&gpc {
	/* use ldo-bypass, u-boot will check it and configure */
	fsl,ldo-bypass = <1>;
};

&fec1 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_enet1>;
	phy-mode = "rgmii";
	status = "okay";
};

&fec2 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_enet2>;
	phy-mode = "rgmii";
	status = "okay";
};

&uart1 { /* ttymxc0 */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart1>;
	status = "okay";
};

&uart2 { /* for RS-485 ttymxc1 & ttymxc2 */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart2>;
        panduit,vmx-rs485-mode;
        panduit,port0-de-gpio = <&gpio1 8 GPIO_ACTIVE_HIGH>;
        panduit,port0-re-gpio = <&gpio1 9 GPIO_ACTIVE_LOW>;
        panduit,port1-de-gpio = <&gpio4 28 GPIO_ACTIVE_HIGH>;
        panduit,port1-re-gpio = <&gpio4 29 GPIO_ACTIVE_LOW>;
	status = "okay";
};

&uart3 { /* for RS-485 ttymxc3 & ttymxc4 */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart3>;
        panduit,vmx-rs485-mode;
        panduit,port0-de-gpio = <&gpio7 9 GPIO_ACTIVE_HIGH>;
        panduit,port0-re-gpio = <&gpio7 8 GPIO_ACTIVE_LOW>;
        panduit,port1-de-gpio = <&gpio4 25 GPIO_ACTIVE_HIGH>;
        panduit,port1-re-gpio = <&gpio4 24 GPIO_ACTIVE_LOW>;
	status = "okay";
};

&uart4 { /* for RS-485 ttymxc5 & ttymxc6 */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart4>;
        panduit,vmx-rs485-mode;
        panduit,port0-de-gpio = <&gpio7 0 GPIO_ACTIVE_HIGH>;
        panduit,port0-re-gpio = <&gpio7 4 GPIO_ACTIVE_LOW>;
        panduit,port1-de-gpio = <&gpio4 27 GPIO_ACTIVE_HIGH>;
        panduit,port1-re-gpio = <&gpio4 26 GPIO_ACTIVE_LOW>;
	status = "okay";
};

&uart5 { /* for RS-485 ttymxc7 & ttymxc8 */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart5>;
        panduit,vmx-rs485-mode;
        panduit,port0-de-gpio = <&gpio2 17 GPIO_ACTIVE_HIGH>;
        panduit,port0-re-gpio = <&gpio2 12 GPIO_ACTIVE_LOW>;
        panduit,port1-de-gpio = <&gpio4 19 GPIO_ACTIVE_HIGH>;
        panduit,port1-re-gpio = <&gpio4 18 GPIO_ACTIVE_LOW>;
	status = "okay";
};

&uart6 { /* for RS-485 ttymxc9 & ttymxc10 */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart6>;
        panduit,vmx-rs485-mode;
        panduit,port0-de-gpio = <&gpio2 15 GPIO_ACTIVE_HIGH>;
        panduit,port0-re-gpio = <&gpio2 10 GPIO_ACTIVE_LOW>;
        panduit,port1-de-gpio = <&gpio4 31 GPIO_ACTIVE_HIGH>;
        panduit,port1-re-gpio = <&gpio4 30 GPIO_ACTIVE_LOW>;
	status = "okay";
};

&usbphy1 {
	tx-d-cal = <0x5>;
};

&usbphy2 {
	tx-d-cal = <0x5>;
};

&usbotg1 { /* USB Badge */
	dr_mode = "peripheral";
	status = "okay";
};

&usbotg2 { /* WSN */
	dr_mode = "host";
	status = "okay";
};

&usbh {
	pinctrl-names = "idle", "active";
	pinctrl-0 = <&pinctrl_usbh_1>;
	pinctrl-1 = <&pinctrl_usbh_2>;
	osc-clkgate-delay = <0x3>;
        non-removable;
	status = "okay";
};

&usdhc2 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_usdhc2>;
	non-removable;
	no-1-8-v;
	keep-power-in-suspend;
	enable-sdio-wakeup;
	status = "okay";
};

&usdhc4 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_usdhc4>;
	bus-width = <8>;
	/*
	 * overwrite cd-gpios and wp-gpios since they are reused as eMMC DATA
	 * signals after rework
	 */
	cd-gpios = <>;
	wp-gpios = <>;
	non-removable;
	status = "okay";
};



&i2c1 {
	clock-frequency = <100000>;
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_i2c1>;
	status = "okay";

	pmic: pfuze100@08 {
		compatible = "fsl,pfuze200";
		reg = <0x08>;

		regulators {
			sw1a_reg: sw1ab {
				regulator-min-microvolt = <300000>;
				regulator-max-microvolt = <1875000>;
				regulator-boot-on;
				regulator-always-on;
				regulator-ramp-delay = <6250>;
			};

			sw2_reg: sw2 {
				regulator-min-microvolt = <800000>;
				regulator-max-microvolt = <3300000>;
				regulator-boot-on;
				regulator-always-on;
			};

			sw3a_reg: sw3a {
				regulator-min-microvolt = <400000>;
				regulator-max-microvolt = <1975000>;
				regulator-boot-on;
				regulator-always-on;
			};

			sw3b_reg: sw3b {
				regulator-min-microvolt = <400000>;
				regulator-max-microvolt = <1975000>;
				regulator-boot-on;
				regulator-always-on;
			};

			swbst_reg: swbst {
				regulator-min-microvolt = <5000000>;
				regulator-max-microvolt = <5150000>;
			};

			snvs_reg: vsnvs {
				regulator-min-microvolt = <1000000>;
				regulator-max-microvolt = <3000000>;
				regulator-boot-on;
				regulator-always-on;
			};

			vref_reg: vrefddr {
				regulator-boot-on;
				regulator-always-on;
			};

			vgen1_reg: vgen1 {
				regulator-min-microvolt = <800000>;
				regulator-max-microvolt = <1550000>;
				regulator-always-on;
			};

			vgen2_reg: vgen2 {
				regulator-min-microvolt = <800000>;
				regulator-max-microvolt = <1550000>;
			};

			vgen3_reg: vgen3 {
				regulator-min-microvolt = <1800000>;
				regulator-max-microvolt = <3300000>;
				regulator-always-on;
			};

			vgen4_reg: vgen4 {
				regulator-min-microvolt = <1800000>;
				regulator-max-microvolt = <3300000>;
				regulator-always-on;
			};

			vgen5_reg: vgen5 {
				regulator-min-microvolt = <1800000>;
				regulator-max-microvolt = <3300000>;
				regulator-always-on;
			};

			vgen6_reg: vgen6 {
				regulator-min-microvolt = <1800000>;
				regulator-max-microvolt = <3300000>;
				regulator-always-on;
			};
		};
	};
};

/*
&i2c2 {
	clock-frequency = <100000>;
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_i2c2>;
	status = "okay";

          usbhub: usb84602@2d {
                  compatible = "smsc,usb84602";
                  reg = <0x2d>;
                  reset-gpios = <&gpio3 22 1>;
                  initial-mode = <1>;
          };
};
*/

&iomuxc {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_hog>;

	imx6x-sdb {
		pinctrl_hog: hoggrp {
			fsl,pins = <
				MX6SX_PAD_SD1_DATA0__GPIO6_IO_2 0x17059
				MX6SX_PAD_SD1_DATA3__GPIO6_IO_5 0xb000
				MX6SX_PAD_CSI_DATA03__GPIO1_IO_17 0x17059
				MX6SX_PAD_GPIO1_IO13__WDOG1_WDOG_ANY 0x30b0
				MX6SX_PAD_QSPI1A_SCLK__GPIO4_IO_21  0x17059
			>;
		};

		pinctrl_enet1: enet1grp {
			fsl,pins = <
				MX6SX_PAD_ENET1_MDIO__ENET1_MDIO	0xa0b1
				MX6SX_PAD_ENET1_MDC__ENET1_MDC		0xa0b1
				MX6SX_PAD_RGMII1_TXC__ENET1_RGMII_TXC	0xa0b9
				MX6SX_PAD_RGMII1_TD0__ENET1_TX_DATA_0	0xa0b1
				MX6SX_PAD_RGMII1_TD1__ENET1_TX_DATA_1	0xa0b1
				MX6SX_PAD_RGMII1_TD2__ENET1_TX_DATA_2	0xa0b1
				MX6SX_PAD_RGMII1_TD3__ENET1_TX_DATA_3	0xa0b1
				MX6SX_PAD_RGMII1_TX_CTL__ENET1_TX_EN	0xa0b1
				MX6SX_PAD_RGMII1_RXC__ENET1_RX_CLK	0x3081
				MX6SX_PAD_RGMII1_RD0__ENET1_RX_DATA_0	0x3081
				MX6SX_PAD_RGMII1_RD1__ENET1_RX_DATA_1	0x3081
				MX6SX_PAD_RGMII1_RD2__ENET1_RX_DATA_2	0x3081
				MX6SX_PAD_RGMII1_RD3__ENET1_RX_DATA_3	0x3081
				MX6SX_PAD_RGMII1_RX_CTL__ENET1_RX_EN	0x3081
				MX6SX_PAD_ENET2_RX_CLK__ENET2_REF_CLK_25M	0x91
			>;
		};

		pinctrl_enet2: enet2grp {
			fsl,pins = <
				MX6SX_PAD_RGMII2_TXC__ENET2_RGMII_TXC	0xa0b9
				MX6SX_PAD_RGMII2_TD0__ENET2_TX_DATA_0	0xa0b1
				MX6SX_PAD_RGMII2_TD1__ENET2_TX_DATA_1	0xa0b1
				MX6SX_PAD_RGMII2_TD2__ENET2_TX_DATA_2	0xa0b1
				MX6SX_PAD_RGMII2_TD3__ENET2_TX_DATA_3	0xa0b1
				MX6SX_PAD_RGMII2_TX_CTL__ENET2_TX_EN	0xa0b1
				MX6SX_PAD_RGMII2_RXC__ENET2_RX_CLK	0x3081
				MX6SX_PAD_RGMII2_RD0__ENET2_RX_DATA_0	0x3081
				MX6SX_PAD_RGMII2_RD1__ENET2_RX_DATA_1	0x3081
				MX6SX_PAD_RGMII2_RD2__ENET2_RX_DATA_2	0x3081
				MX6SX_PAD_RGMII2_RD3__ENET2_RX_DATA_3	0x3081
				MX6SX_PAD_RGMII2_RX_CTL__ENET2_RX_EN	0x3081
			>;
		};

		pinctrl_i2c1: i2c1grp {
			fsl,pins = <
				MX6SX_PAD_GPIO1_IO01__I2C1_SDA 0x4001b8b1
				MX6SX_PAD_GPIO1_IO00__I2C1_SCL 0x4001b8b1
			>;
		};

		pinctrl_i2c2: i2c2grp {
			fsl,pins = <
				MX6SX_PAD_GPIO1_IO03__I2C2_SDA 0x4001b8b1
				MX6SX_PAD_GPIO1_IO02__I2C2_SCL 0x4001b8b1
			>;
		};

		pinctrl_uart1: uart1grp {
			fsl,pins = <
				MX6SX_PAD_GPIO1_IO04__UART1_TX		0x1b0b1
				MX6SX_PAD_GPIO1_IO05__UART1_RX		0x1b0b1
			>;
		};

                pinctrl_uart2: uart2grp {
		        fsl,pins = <
				MX6SX_PAD_GPIO1_IO06__UART2_TX		0x1b0b1
				MX6SX_PAD_GPIO1_IO07__UART2_RX		0x1b0b1
				MX6SX_PAD_GPIO1_IO08__GPIO1_IO_8	0x10b0
				MX6SX_PAD_GPIO1_IO09__GPIO1_IO_9	0x10b0
                                MX6SX_PAD_QSPI1B_SCLK__GPIO4_IO_29      0x10b0
                                MX6SX_PAD_QSPI1B_DQS__GPIO4_IO_28       0x10b0
			>;
		};

                pinctrl_uart3: uart3grp {
		        fsl,pins = <
				MX6SX_PAD_SD3_DATA4__UART3_RX		0x1b0b1
				MX6SX_PAD_SD3_DATA5__UART3_TX		0x1b0b1
				MX6SX_PAD_SD3_DATA6__GPIO7_IO_8		0x10b0
				MX6SX_PAD_SD3_DATA7__GPIO7_IO_9		0x10b0
                                MX6SX_PAD_QSPI1B_DATA0__GPIO4_IO_24     0x10b0
                                MX6SX_PAD_QSPI1B_DATA1__GPIO4_IO_25     0x10b0

			>;
		};

                pinctrl_uart4: uart4grp {
		        fsl,pins = <
				MX6SX_PAD_SD3_CMD__UART4_TX		0x1b0b1
				MX6SX_PAD_SD3_DATA3__UART4_RX		0x1b0b1
                                MX6SX_PAD_SD3_CLK__GPIO7_IO_0           0x10b0
                                MX6SX_PAD_SD3_DATA2__GPIO7_IO_4         0x10b0
                                MX6SX_PAD_QSPI1B_DATA2__GPIO4_IO_26     0x10b0
                                MX6SX_PAD_QSPI1B_DATA3__GPIO4_IO_27     0x10b0
			>;
		};

                pinctrl_uart5: uart5grp {
			fsl,pins = <
				MX6SX_PAD_KEY_COL3__UART5_TX		0x1b0b1
				MX6SX_PAD_KEY_ROW3__UART5_RX		0x1b0b1
				MX6SX_PAD_KEY_ROW2__GPIO2_IO_17	        0x10b0
				MX6SX_PAD_KEY_COL2__GPIO2_IO_12	        0x10b0
                                MX6SX_PAD_QSPI1A_DATA2__GPIO4_IO_18     0x10b0
                                MX6SX_PAD_QSPI1A_DATA3__GPIO4_IO_19     0x10b0
			>;
		};

                pinctrl_uart6: uart6grp {
			fsl,pins = <
				MX6SX_PAD_KEY_COL1__UART6_TX		0x1b0b1
				MX6SX_PAD_KEY_ROW1__UART6_RX		0x1b0b1
                                MX6SX_PAD_KEY_ROW0__GPIO2_IO_15         0x10b0
                                MX6SX_PAD_KEY_COL0__GPIO2_IO_10         0x10b0
                                MX6SX_PAD_QSPI1B_SS0_B__GPIO4_IO_30     0x10b0
                                MX6SX_PAD_QSPI1B_SS1_B__GPIO4_IO_31     0x10b0
			>;
		};

	        pinctrl_usbh_1: usbhgrp-1 {
                        fsl,pins = <
                                MX6SX_PAD_USB_H_STROBE__USB_H_STROBE	0x13030
                                MX6SX_PAD_USB_H_DATA__USB_H_DATA        0x13030
                        >;
	        };

	        pinctrl_usbh_2: usbhgrp-2 {
                fsl,pins = <
                                MX6SX_PAD_USB_H_STROBE__USB_H_STROBE	0x17030
                                MX6SX_PAD_USB_H_DATA__USB_H_DATA        0x13030
                         >;
	        };

		pinctrl_usdhc2: usdhc2grp {
			fsl,pins = <
				MX6SX_PAD_SD2_CMD__USDHC2_CMD		0x17059
				MX6SX_PAD_SD2_CLK__USDHC2_CLK		0x10059
				MX6SX_PAD_SD2_DATA0__USDHC2_DATA0	0x17059
				MX6SX_PAD_SD2_DATA1__USDHC2_DATA1	0x17059
				MX6SX_PAD_SD2_DATA2__USDHC2_DATA2	0x17059
				MX6SX_PAD_SD2_DATA3__USDHC2_DATA3	0x17059
			>;
		};

		pinctrl_usdhc4: usdhc4grp {
			fsl,pins = <
				MX6SX_PAD_SD4_CMD__USDHC4_CMD		0x17059
				MX6SX_PAD_SD4_CLK__USDHC4_CLK		0x10059
				MX6SX_PAD_SD4_DATA0__USDHC4_DATA0	0x17059
				MX6SX_PAD_SD4_DATA1__USDHC4_DATA1	0x17059
				MX6SX_PAD_SD4_DATA2__USDHC4_DATA2	0x17059
				MX6SX_PAD_SD4_DATA3__USDHC4_DATA3	0x17059
				MX6SX_PAD_SD4_DATA4__USDHC4_DATA4	0x17059
				MX6SX_PAD_SD4_DATA5__USDHC4_DATA5	0x17059
				MX6SX_PAD_SD4_DATA6__USDHC4_DATA6	0x17059
				MX6SX_PAD_SD4_DATA7__USDHC4_DATA7	0x17059
			>;
		};
	};
};

